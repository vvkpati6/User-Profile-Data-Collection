<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOOVA - Profile Collection Portal</title>
    <style>
        :root {
            --soova-blue: #1a73e8;
            --soova-green: #2e7d32;
            --light-bg: #f8f9fa;
        }
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #eef2f7; padding: 15px; margin: 0; }
        
        .container { max-width: 800px; margin: auto; background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        
        /* Header & Logo */
        .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            background: white; 
            padding: 20px; 
            border-bottom: 4px solid var(--soova-blue);
        }
        .logo-box { width: 70px; height: 70px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--soova-blue); border: 2px solid var(--soova-green); font-size: 11px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        h2 { color: var(--soova-blue); text-align: center; margin: 5px 0; text-transform: uppercase; letter-spacing: 1px; }
        
        .form-content { padding: 25px; }
        .section { margin-bottom: 25px; padding: 15px; border: 1px solid #e0e0e0; border-radius: 8px; background-color: var(--light-bg); border-left: 5px solid var(--soova-green); }
        .section-title { font-weight: bold; color: var(--soova-blue); margin-bottom: 15px; text-transform: uppercase; font-size: 13px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        
        label { display: block; margin-bottom: 5px; font-weight: 600; color: #444; font-size: 13px; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 14px; }
        input[readonly] { background-color: #f1f3f4; cursor: not-allowed; color: #666; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; }
        
        /* Buttons */
        .btn-container { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
        .btn { padding: 16px; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; color: white; transition: 0.3s; text-transform: uppercase; }
        .save-btn { background: linear-gradient(to right, var(--soova-blue), #0d47a1); }
        .download-btn { background: linear-gradient(to right, var(--soova-green), #1b5e20); }
        .btn:active { transform: scale(0.98); }

        /* Footer */
        .footer { background: #333; color: #ccc; text-align: center; padding: 20px; font-size: 12px; line-height: 1.6; }
        .footer b { color: white; }

        #status { margin-top: 15px; text-align: center; font-weight: bold; }
    </style>
</head>
<body onload="updateButtonCount()">

<div class="container">
    <div class="header">
        <div class="logo-box">SOOVA</div>
        <div style="text-align:center;">
            <h2 style="margin:0; font-size: 26px;">SOOVA</h2>
            <small style="color:var(--soova-green); font-weight:bold;">Profile Collection Portal</small>
        </div>
        <div class="logo-box">SOOVA</div>
    </div>

    <form id="profileForm" class="form-content">
        <div class="section">
            <div class="section-title">1. Collection Info</div>
            <div class="grid">
                <div class="form-group"><label>Collector Name</label><input type="text" id="field2" placeholder="Vivek Aryan Pati"></div>
                <div class="form-group">
                    <label>Mode of Collection</label>
                    <select id="field3">
                        <option value="Physical">Physical</option>
                        <option value="Telephonic">Telephonic</option>
                    </select>
                </div>
            </div>
            <div class="form-group"><label>Partner Network / Private Group</label><input type="text" id="field4" value="SOOVA" readonly></div>
        </div>

        <div class="section">
            <div class="section-title">2. Beneficiary Profile</div>
            <div class="form-group"><label>Name of the Beneficiary</label><input type="text" id="field5" required></div>
            <div class="grid">
                <div class="form-group"><label>Gender</label><select id="field6"><option>Male</option><option>Female</option><option>Other</option></select></div>
                <div class="form-group"><label>Year of Birth</label><input type="number" id="field7" placeholder="YYYY"></div>
            </div>
            <div class="grid">
                <div class="form-group"><label>Mobile (10 Digits)</label><input type="text" id="field8" maxlength="10"></div>
                <div class="form-group"><label>WhatsApp Linked?</label><select id="field9"><option>Yes</option><option>No</option></select></div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">3. Location Details</div>
            <div class="grid">
                <div class="form-group"><label>State</label><input type="text" id="field10" value="Odisha" readonly></div>
                <div class="form-group"><label>District</label><input type="text" id="field11" value="Mayurbhanj" readonly></div>
            </div>
            <div class="grid">
                <div class="form-group">
                    <label>Block</label>
                    <select id="field12">
                        <option value="Udala">Udala</option>
                        <option value="Kaptipada">Kaptipada</option>
                        <option value="Samakhunta">Samakhunta</option>
                    </select>
                </div>
                <div class="form-group"><label>Revenue Village</label><input type="text" id="field13"></div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">4. Occupation & Land</div>
            <div class="form-group"><label>Total Land Holding (Acre)</label><input type="number" step="0.01" id="field17" value="0"></div>
            <div class="grid">
                <div><label>Crop 1 Area</label><input type="number" step="0.01" id="field19" class="crop-land" value="0"></div>
                <div><label>Crop 2 Area</label><input type="number" step="0.01" id="field21" class="crop-land" value="0"></div>
            </div>
        </div>

        <div class="btn-container">
            <button type="button" class="btn save-btn" onclick="saveData()">ðŸ’¾ Secure Save</button>
            <button type="button" id="downloadBtn" class="btn download-btn" onclick="downloadCSV()">ðŸ“¥ Download All Data (0)</button>
        </div>
        <div id="status"></div>
    </form>

    <div class="footer">
        Made by <b>Vivek Aryan Pati</b><br>
        Copyright Â© <b>SOOVA 2026</b>
    </div>
</div>

<script>
    const HEADERS = ["Date and Time", "Collector Name", "Mode of Collection", "Partner Network", "Beneficiary Name", "Gender", "Year of Birth", "Mobile", "WhatsApp Linked", "State", "District", "Block", "Revenue Village", "Sub Village", "Occupation Category", "Profile Type", "Total Land", "Crop 1", "Land 1", "Crop 2", "Land 2", "Crop 3", "Land 3", "Crop 4", "Land 4", "Crop 5", "Land 5", "No of Goats", "No of Poultry", "No of Cows", "Other Animal 1", "Nos 1", "Other Animal 2", "Nos 2", "Other Animal 3", "Nos 3", "Milk Societies", "Poultry Farming", "Craft Owner", "Type of Craft", "Gear/Net", "Fish Landing Centre"];

    function updateButtonCount() {
        const db = JSON.parse(localStorage.getItem('soovaSurvey')) || [];
        document.getElementById('downloadBtn').innerText = `ðŸ“¥ Download All Data (${db.length})`;
    }

    function saveData() {
        const name = document.getElementById('field5').value;
        const mobile = document.getElementById('field8').value;
        const totalLand = parseFloat(document.getElementById('field17').value) || 0;

        if(!name) { alert("Please enter the Beneficiary Name."); return; }
        if(mobile.length !== 10 || isNaN(mobile)) { alert("Error: Mobile number must be 10 digits."); return; }

        let sumCrop = 0;
        document.querySelectorAll('.crop-land').forEach(input => sumCrop += parseFloat(input.value) || 0);
        if(sumCrop > totalLand) { alert(`Error: Crop land (${sumCrop}) exceeds Total Land (${totalLand}).`); return; }

        let entry = { "Date and Time": new Date().toLocaleString() };
        for(let i=2; i<=42; i++) {
            const el = document.getElementById('field' + i);
            entry[HEADERS[i-1]] = el ? el.value : "";
        }
        entry["State"] = "Odisha"; entry["District"] = "Mayurbhanj";

        let db = JSON.parse(localStorage.getItem('soovaSurvey')) || [];
        db.push(entry);
        localStorage.setItem('soovaSurvey', JSON.stringify(db));

        document.getElementById('status').innerHTML = "<span style='color:var(--soova-green)'>âœ… Saved! Total: " + db.length + "</span>";
        document.getElementById('profileForm').reset();
        
        // Restore locked fields
        document.getElementById('field4').value = "SOOVA";
        document.getElementById('field10').value = "Odisha";
        document.getElementById('field11').value = "Mayurbhanj";
        
        updateButtonCount();
        window.scrollTo(0,0);
        setTimeout(() => { document.getElementById('status').innerText = ""; }, 3000);
    }

    function downloadCSV() {
        const data = JSON.parse(localStorage.getItem('soovaSurvey'));
        if (!data || data.length === 0) { alert("No data to export."); return; }
        const csvRows = [HEADERS.join(",")];
        for (const row of data) {
            const values = HEADERS.map(h => `"${(row[h] || "").toString().replace(/"/g, '""')}"`);
            csvRows.push(values.join(","));
        }
        const blob = new Blob(["\uFEFF" + csvRows.join("\n")], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `SOOVA_Survey_${new Date().toLocaleDateString()}.csv`;
        a.click();
    }
</script>

</body>
</html>
