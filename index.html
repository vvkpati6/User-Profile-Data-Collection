<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOOVA - Admin & Profile Portal</title>
    <style>
        :root {
            --soova-blue: #1a73e8;
            --soova-green: #2e7d32;
            --light-bg: #f8f9fa;
            --danger: #d93025;
        }
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #eef2f7; padding: 15px; margin: 0; }
        
        .container { max-width: 950px; margin: auto; background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        
        /* Header */
        .header { display: flex; justify-content: space-between; align-items: center; background: white; padding: 20px; border-bottom: 4px solid var(--soova-blue); }
        .logo-box { width: 60px; height: 60px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--soova-blue); border: 2px solid var(--soova-green); font-size: 10px; text-align: center; }
        
        /* Navigation Tabs */
        .nav-tabs { display: flex; background: #f1f3f4; }
        .tab-btn { flex: 1; padding: 15px; border: none; cursor: pointer; font-weight: bold; background: #f1f3f4; color: #5f6368; transition: 0.3s; }
        .tab-btn.active { background: white; color: var(--soova-blue); border-bottom: 3px solid var(--soova-blue); }

        .form-content, .dashboard-content { padding: 25px; display: none; }
        .active-content { display: block; }

        /* Form Styling */
        .section { margin-bottom: 25px; padding: 15px; border: 1px solid #e0e0e0; border-radius: 8px; background-color: var(--light-bg); border-left: 5px solid var(--soova-green); }
        .section-title { font-weight: bold; color: var(--soova-blue); margin-bottom: 15px; text-transform: uppercase; font-size: 13px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; color: #444; font-size: 13px; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 14px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }

        /* Dashboard Table */
        .table-container { overflow-x: auto; margin-top: 15px; border: 1px solid #ddd; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th { background: var(--soova-blue); color: white; padding: 12px; text-align: left; position: sticky; top: 0; }
        td { padding: 10px; border-bottom: 1px solid #eee; }
        .search-bar { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 25px; border: 1px solid #ddd; outline: none; }

        /* Buttons */
        .btn { padding: 15px; border: none; border-radius: 8px; font-size: 15px; font-weight: bold; cursor: pointer; color: white; text-transform: uppercase; }
        .save-btn { background: var(--soova-blue); width: 100%; margin-top: 10px; }
        .download-btn { background: var(--soova-green); width: 100%; }
        .delete-btn { background: var(--danger); color: white; padding: 5px 10px; border-radius: 4px; border: none; cursor: pointer; }
        .clear-btn { background: #555; margin-top: 10px; }

        .footer { background: #333; color: #ccc; text-align: center; padding: 20px; font-size: 12px; }
    </style>
</head>
<body onload="refreshApp()">

<div class="container">
    <div class="header">
        <div class="logo-box">SOOVA</div>
        <div style="text-align:center;">
            <h2 style="margin:0; font-size: 22px; color: var(--soova-blue);">SOOVA</h2>
            <small style="color:var(--soova-green); font-weight:bold;">Empowering Communities</small>
        </div>
        <div class="logo-box">SOOVA</div>
    </div>

    <div class="nav-tabs">
        <button class="tab-btn active" id="entryTab" onclick="showPage('entry')">üìù DATA ENTRY</button>
        <button class="tab-btn" id="dashTab" onclick="showPage('dash')">üìä ADMIN DASHBOARD</button>
    </div>

    <div id="entryPage" class="form-content active-content">
        <form id="profileForm">
            <div class="section">
                <div class="section-title">1. Collection Info</div>
                <div class="grid">
                    <div class="form-group"><label>Collector Name</label><input type="text" id="field2" placeholder="Vivek Aryan Pati"></div>
                    <div class="form-group"><label>Mode</label><select id="field3"><option>Physical</option><option>Telephonic</option></select></div>
                    <div class="form-group"><label>Partner</label><input type="text" id="field4" value="SOOVA" readonly></div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">2. Beneficiary Profile</div>
                <div class="form-group"><label>Beneficiary Name</label><input type="text" id="field5" required></div>
                <div class="grid">
                    <div class="form-group"><label>Mobile (10 Digits)</label><input type="text" id="field8" maxlength="10"></div>
                    <div class="form-group"><label>Block</label><select id="field12"><option>Udala</option><option>Kaptipada</option><option>Samakhunta</option></select></div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">3. Land Logic</div>
                <div class="grid">
                    <div class="form-group"><label>Total Land (Acre)</label><input type="number" step="0.01" id="field17" value="0"></div>
                    <div class="form-group"><label>Crop 1 Area</label><input type="number" step="0.01" id="field19" class="crop-land" value="0"></div>
                </div>
            </div>

            <button type="button" class="btn save-btn" onclick="saveData()">üíæ Secure Save Entry</button>
            <div id="status" style="text-align: center; margin-top: 10px;"></div>
        </form>
    </div>

    <div id="dashPage" class="dashboard-content">
        <input type="text" class="search-bar" id="search" placeholder="üîç Search by name or village..." onkeyup="renderTable()">
        
        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Name</th>
                        <th>Mobile</th>
                        <th>Village</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>

        <div style="margin-top: 20px;">
            <button type="button" id="downloadBtn" class="btn download-btn" onclick="downloadCSV()">üì• Download All Data (0)</button>
            <button type="button" class="btn clear-btn" onclick="clearAllData()">‚ö†Ô∏è Clear All Local Records</button>
        </div>
    </div>

    <div class="footer">
        Made by <b>Vivek Aryan Pati</b> | Copyright ¬© <b>SOOVA 2026</b>
    </div>
</div>

<script>
    const HEADERS = ["Date and Time", "Collector Name", "Mode", "Partner", "Beneficiary Name", "Gender", "Year", "Mobile", "WhatsApp", "State", "District", "Block", "Revenue Village", "Sub Village", "Occupation", "Profile Type", "Total Land", "Crop 1", "Land 1", "Crop 2", "Land 2", "Crop 3", "Land 3", "Crop 4", "Land 4", "Crop 5", "Land 5", "Goats", "Poultry", "Cows", "Other 1", "Nos 1", "Other 2", "Nos 2", "Other 3", "Nos 3", "Milk Soc", "Poultry Farm", "Craft", "Type Craft", "Gear", "Fish Landing"];

    function showPage(page) {
        document.getElementById('entryPage').classList.toggle('active-content', page === 'entry');
        document.getElementById('dashPage').classList.toggle('active-content', page === 'dash');
        document.getElementById('entryTab').classList.toggle('active', page === 'entry');
        document.getElementById('dashTab').classList.toggle('active', page === 'dash');
        if(page === 'dash') renderTable();
    }

    function saveData() {
        const name = document.getElementById('field5').value;
        const mobile = document.getElementById('field8').value;
        const totalLand = parseFloat(document.getElementById('field17').value) || 0;

        if(!name || mobile.length !== 10) { alert("Please fix Name and Mobile (10 digits)."); return; }

        let sumCrop = 0;
        document.querySelectorAll('.crop-land').forEach(i => sumCrop += parseFloat(i.value) || 0);
        if(sumCrop > totalLand) { alert("Crop area cannot exceed total land."); return; }

        let entry = { "Date and Time": new Date().toLocaleString() };
        for(let i=2; i<=42; i++) {
            const el = document.getElementById('field' + i);
            entry[HEADERS[i-1]] = el ? el.value : "";
        }
        entry["State"] = "Odisha"; entry["District"] = "Mayurbhanj";

        let db = JSON.parse(localStorage.getItem('soovaDB')) || [];
        db.push(entry);
        localStorage.setItem('soovaDB', JSON.stringify(db));

        document.getElementById('status').innerHTML = "‚úÖ Saved!";
        document.getElementById('profileForm').reset();
        refreshApp();
    }

    function renderTable() {
        const db = JSON.parse(localStorage.getItem('soovaDB')) || [];
        const searchTerm = document.getElementById('search').value.toLowerCase();
        const body = document.getElementById('tableBody');
        body.innerHTML = "";

        db.forEach((row, index) => {
            if (row["Beneficiary Name"].toLowerCase().includes(searchTerm)) {
                body.innerHTML += `
                    <tr>
                        <td>${row["Date and Time"].split(',')[0]}</td>
                        <td>${row["Beneficiary Name"]}</td>
                        <td>${row["Mobile"]}</td>
                        <td>${row["Revenue Village"] || 'N/A'}</td>
                        <td><button class="delete-btn" onclick="deleteEntry(${index})">üóëÔ∏è</button></td>
                    </tr>
                `;
            }
        });
    }

    function deleteEntry(index) {
        if(confirm("Delete this record?")) {
            let db = JSON.parse(localStorage.getItem('soovaDB'));
            db.splice(index, 1);
            localStorage.setItem('soovaDB', JSON.stringify(db));
            refreshApp();
            renderTable();
        }
    }

    function clearAllData() {
        if(confirm("This will delete ALL entries from this device. Are you sure?")) {
            localStorage.removeItem('soovaDB');
            refreshApp();
            renderTable();
        }
    }

    function refreshApp() {
        const db = JSON.parse(localStorage.getItem('soovaDB')) || [];
        document.getElementById('downloadBtn').innerText = `üì• Download All Data (${db.length})`;
    }

    function downloadCSV() {
        const data = JSON.parse(localStorage.getItem('soovaDB'));
        if (!data || data.length === 0) { alert("No data."); return; }
        const csvRows = [HEADERS.join(",")];
        data.forEach(row => csvRows.push(HEADERS.map(h => `"${(row[h] || "").toString().replace(/"/g, '""')}"`).join(",")));
        const blob = new Blob(["\uFEFF" + csvRows.join("\n")], { type: 'text/csv;charset=utf-8;' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = `SOOVA_Export_${new Date().toLocaleDateString()}.csv`;
        a.click();
    }
</script>
</body>
</html>
